import{r as m,G as b,_ as y,H as w,t as J,I as Z,J as ee,K}from"./index-ZNH9tNY-.js";import{a as ne,_ as re,c as te,i as B}from"./isObjectLike-S4Xuhf35.js";var ie=function(e){return function(n,r){var t=m.useRef(!1);e(function(){return function(){t.current=!1}},[]),e(function(){if(!t.current)t.current=!0;else return n()},r)}},ue=function(e){return typeof e=="function"};function x(e){var n=m.useRef(e);n.current=m.useMemo(function(){return e},[e]);var r=m.useRef();return r.current||(r.current=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return n.current.apply(this,t)}),r.current}const N=ie(m.useEffect);var V=function(e,n){var r=n.manual,t=n.ready,i=t===void 0?!0:t,o=n.defaultParams,a=o===void 0?[]:o,s=n.refreshDeps,c=s===void 0?[]:s,u=n.refreshDepsAction,v=m.useRef(!1);return v.current=!1,N(function(){!r&&i&&(v.current=!0,e.run.apply(e,b([],y(a),!1)))},[i]),N(function(){v.current||r||(v.current=!0,u?u():e.refresh())},b([],y(c),!1)),{onBefore:function(){if(!i)return{stopNow:!0}}}};V.onInit=function(e){var n=e.ready,r=n===void 0?!0:n,t=e.manual;return{loading:!t&&r}};const ae=V;function oe(e,n){if(e===n)return!0;for(var r=0;r<e.length;r++)if(!Object.is(e[r],n[r]))return!1;return!0}function q(e,n){var r=m.useRef({deps:n,obj:void 0,initialized:!1}).current;return(r.initialized===!1||!oe(r.deps,n))&&(r.deps=n,r.obj=e(),r.initialized=!0),r.obj}function Q(e){var n=m.useRef(e);return n.current=e,n}var H=function(e){var n=Q(e);m.useEffect(function(){return function(){n.current()}},[])},W=new Map,se=function(e,n,r){var t=W.get(e);t!=null&&t.timer&&clearTimeout(t.timer);var i=void 0;n>-1&&(i=setTimeout(function(){W.delete(e)},n)),W.set(e,w(w({},r),{timer:i}))},ce=function(e){return W.get(e)},j=new Map,fe=function(e){return j.get(e)},le=function(e,n){j.set(e,n),n.then(function(r){return j.delete(e),r}).catch(function(){j.delete(e)})},S={},de=function(e,n){S[e]&&S[e].forEach(function(r){return r(n)})},M=function(e,n){return S[e]||(S[e]=[]),S[e].push(n),function(){var t=S[e].indexOf(n);S[e].splice(t,1)}},ve=function(e,n){var r=n.cacheKey,t=n.cacheTime,i=t===void 0?5*60*1e3:t,o=n.staleTime,a=o===void 0?0:o,s=n.setCache,c=n.getCache,u=m.useRef(),v=m.useRef(),f=function(l,d){s?s(d):se(l,i,d),de(l,d.data)},h=function(l,d){return d===void 0&&(d=[]),c?c(d):ce(l)};return q(function(){if(r){var l=h(r);l&&Object.hasOwnProperty.call(l,"data")&&(e.state.data=l.data,e.state.params=l.params,(a===-1||new Date().getTime()-l.time<=a)&&(e.state.loading=!1)),u.current=M(r,function(d){e.setState({data:d})})}},[]),H(function(){var l;(l=u.current)===null||l===void 0||l.call(u)}),r?{onBefore:function(l){var d=h(r,l);return!d||!Object.hasOwnProperty.call(d,"data")?{}:a===-1||new Date().getTime()-d.time<=a?{loading:!1,data:d==null?void 0:d.data,error:void 0,returnNow:!0}:{data:d==null?void 0:d.data,error:void 0}},onRequest:function(l,d){var p=fe(r);return p&&p!==v.current?{servicePromise:p}:(p=l.apply(void 0,b([],y(d),!1)),v.current=p,le(r,p),{servicePromise:p})},onSuccess:function(l,d){var p;r&&((p=u.current)===null||p===void 0||p.call(u),f(r,{data:l,params:d,time:new Date().getTime()}),u.current=M(r,function(C){e.setState({data:C})}))},onMutate:function(l){var d;r&&((d=u.current)===null||d===void 0||d.call(u),f(r,{data:l,params:e.state.params,time:new Date().getTime()}),u.current=M(r,function(p){e.setState({data:p})}))}}:{}};const me=ve;var ge=ne,he=function(){return ge.Date.now()},pe=he,be=/\s/;function ye(e){for(var n=e.length;n--&&be.test(e.charAt(n)););return n}var Re=ye,Pe=Re,Te=/^\s+/;function we(e){return e&&e.slice(0,Pe(e)+1).replace(Te,"")}var Ee=we,Ce=re,Se=te,Oe="[object Symbol]";function xe(e){return typeof e=="symbol"||Se(e)&&Ce(e)==Oe}var $e=xe,Ae=Ee,z=B,_e=$e,G=NaN,Fe=/^[-+]0x[0-9a-f]+$/i,We=/^0b[01]+$/i,je=/^0o[0-7]+$/i,Le=parseInt;function Me(e){if(typeof e=="number")return e;if(_e(e))return G;if(z(e)){var n=typeof e.valueOf=="function"?e.valueOf():e;e=z(n)?n+"":n}if(typeof e!="string")return e===0?e:+e;e=Ae(e);var r=We.test(e);return r||je.test(e)?Le(e.slice(2),r?2:8):Fe.test(e)?G:+e}var De=Me,Ne=B,D=pe,X=De,Be="Expected a function",He=Math.max,Ie=Math.min;function Ue(e,n,r){var t,i,o,a,s,c,u=0,v=!1,f=!1,h=!0;if(typeof e!="function")throw new TypeError(Be);n=X(n)||0,Ne(r)&&(v=!!r.leading,f="maxWait"in r,o=f?He(X(r.maxWait)||0,n):o,h="trailing"in r?!!r.trailing:h);function l(g){var P=t,T=i;return t=i=void 0,u=g,a=e.apply(T,P),a}function d(g){return u=g,s=setTimeout(E,n),v?l(g):a}function p(g){var P=g-c,T=g-u,U=n-P;return f?Ie(U,o-T):U}function C(g){var P=g-c,T=g-u;return c===void 0||P>=n||P<0||f&&T>=o}function E(){var g=D();if(C(g))return $(g);s=setTimeout(E,p(g))}function $(g){return s=void 0,h&&t?l(g):(t=i=void 0,a)}function A(){s!==void 0&&clearTimeout(s),u=0,t=c=i=s=void 0}function O(){return s===void 0?a:$(D())}function R(){var g=D(),P=C(g);if(t=arguments,i=this,c=g,P){if(s===void 0)return d(c);if(f)return clearTimeout(s),s=setTimeout(E,n),l(c)}return s===void 0&&(s=setTimeout(E,n)),a}return R.cancel=A,R.flush=O,R}var Y=Ue;const ze=J(Y);var Ge=function(e,n){var r=n.debounceWait,t=n.debounceLeading,i=n.debounceTrailing,o=n.debounceMaxWait,a=m.useRef(),s=m.useMemo(function(){var c={};return t!==void 0&&(c.leading=t),i!==void 0&&(c.trailing=i),o!==void 0&&(c.maxWait=o),c},[t,i,o]);return m.useEffect(function(){if(r){var c=e.runAsync.bind(e);return a.current=ze(function(u){u()},r,s),e.runAsync=function(){for(var u=[],v=0;v<arguments.length;v++)u[v]=arguments[v];return new Promise(function(f,h){var l;(l=a.current)===null||l===void 0||l.call(a,function(){c.apply(void 0,b([],y(u),!1)).then(f).catch(h)})})},function(){var u;(u=a.current)===null||u===void 0||u.cancel(),e.runAsync=c}}},[r,s]),r?{onCancel:function(){var c;(c=a.current)===null||c===void 0||c.cancel()}}:{}};const Xe=Ge;var ke=function(e,n){var r=n.loadingDelay,t=n.ready,i=m.useRef();if(!r)return{};var o=function(){i.current&&clearTimeout(i.current)};return{onBefore:function(){return o(),t!==!1&&(i.current=setTimeout(function(){e.setState({loading:!0})},r)),{loading:!1}},onFinally:function(){o()},onCancel:function(){o()}}};const Je=ke;var L=!!(typeof window<"u"&&window.document&&window.document.createElement);function I(){return L?document.visibilityState!=="hidden":!0}var _=[];function Ke(e){return _.push(e),function(){var r=_.indexOf(e);_.splice(r,1)}}if(L){var Ve=function(){if(I())for(var e=0;e<_.length;e++){var n=_[e];n()}};window.addEventListener("visibilitychange",Ve,!1)}var qe=function(e,n){var r=n.pollingInterval,t=n.pollingWhenHidden,i=t===void 0?!0:t,o=n.pollingErrorRetryCount,a=o===void 0?-1:o,s=m.useRef(),c=m.useRef(),u=m.useRef(0),v=function(){var f;s.current&&clearTimeout(s.current),(f=c.current)===null||f===void 0||f.call(c)};return N(function(){r||v()},[r]),r?{onBefore:function(){v()},onError:function(){u.current+=1},onSuccess:function(){u.current=0},onFinally:function(){a===-1||a!==-1&&u.current<=a?s.current=setTimeout(function(){!i&&!I()?c.current=Ke(function(){e.refresh()}):e.refresh()},r):u.current=0},onCancel:function(){v()}}:{}};const Qe=qe;function Ye(e,n){var r=!1;return function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];r||(r=!0,e.apply(void 0,b([],y(t),!1)),setTimeout(function(){r=!1},n))}}function Ze(){return L&&typeof navigator.onLine<"u"?navigator.onLine:!0}var F=[];function en(e){return F.push(e),function(){var r=F.indexOf(e);r>-1&&F.splice(r,1)}}if(L){var k=function(){if(!(!I()||!Ze()))for(var e=0;e<F.length;e++){var n=F[e];n()}};window.addEventListener("visibilitychange",k,!1),window.addEventListener("focus",k,!1)}var nn=function(e,n){var r=n.refreshOnWindowFocus,t=n.focusTimespan,i=t===void 0?5e3:t,o=m.useRef(),a=function(){var s;(s=o.current)===null||s===void 0||s.call(o)};return m.useEffect(function(){if(r){var s=Ye(e.refresh.bind(e),i);o.current=en(function(){s()})}return function(){a()}},[r,i]),H(function(){a()}),{}};const rn=nn;var tn=function(e,n){var r=n.retryInterval,t=n.retryCount,i=m.useRef(),o=m.useRef(0),a=m.useRef(!1);return t?{onBefore:function(){a.current||(o.current=0),a.current=!1,i.current&&clearTimeout(i.current)},onSuccess:function(){o.current=0},onError:function(){if(o.current+=1,t===-1||o.current<=t){var s=r??Math.min(1e3*Math.pow(2,o.current),3e4);i.current=setTimeout(function(){a.current=!0,e.refresh()},s)}else o.current=0},onCancel:function(){o.current=0,i.current&&clearTimeout(i.current)}}:{}};const un=tn;var an=Y,on=B,sn="Expected a function";function cn(e,n,r){var t=!0,i=!0;if(typeof e!="function")throw new TypeError(sn);return on(r)&&(t="leading"in r?!!r.leading:t,i="trailing"in r?!!r.trailing:i),an(e,n,{leading:t,maxWait:n,trailing:i})}var fn=cn;const ln=J(fn);var dn=function(e,n){var r=n.throttleWait,t=n.throttleLeading,i=n.throttleTrailing,o=m.useRef(),a={};return t!==void 0&&(a.leading=t),i!==void 0&&(a.trailing=i),m.useEffect(function(){if(r){var s=e.runAsync.bind(e);return o.current=ln(function(c){c()},r,a),e.runAsync=function(){for(var c=[],u=0;u<arguments.length;u++)c[u]=arguments[u];return new Promise(function(v,f){var h;(h=o.current)===null||h===void 0||h.call(o,function(){s.apply(void 0,b([],y(c),!1)).then(v).catch(f)})})},function(){var c;e.runAsync=s,(c=o.current)===null||c===void 0||c.cancel()}}},[r,t,i]),r?{onCancel:function(){var s;(s=o.current)===null||s===void 0||s.cancel()}}:{}};const vn=dn;var mn=function(e){m.useEffect(function(){e==null||e()},[])},gn=function(){var e=y(m.useState({}),2),n=e[1];return m.useCallback(function(){return n({})},[])},hn=function(){function e(n,r,t,i){i===void 0&&(i={}),this.serviceRef=n,this.options=r,this.subscribe=t,this.initState=i,this.count=0,this.state={loading:!1,params:void 0,data:void 0,error:void 0},this.state=w(w(w({},this.state),{loading:!r.manual}),i)}return e.prototype.setState=function(n){n===void 0&&(n={}),this.state=w(w({},this.state),n),this.subscribe()},e.prototype.runPluginHandler=function(n){for(var r=[],t=1;t<arguments.length;t++)r[t-1]=arguments[t];var i=this.pluginImpls.map(function(o){var a;return(a=o[n])===null||a===void 0?void 0:a.call.apply(a,b([o],y(r),!1))}).filter(Boolean);return Object.assign.apply(Object,b([{}],y(i),!1))},e.prototype.runAsync=function(){for(var n,r,t,i,o,a,s,c,u,v,f=[],h=0;h<arguments.length;h++)f[h]=arguments[h];return Z(this,void 0,void 0,function(){var l,d,p,C,E,$,A,O,R,g,P;return ee(this,function(T){switch(T.label){case 0:if(this.count+=1,l=this.count,d=this.runPluginHandler("onBefore",f),p=d.stopNow,C=p===void 0?!1:p,E=d.returnNow,$=E===void 0?!1:E,A=K(d,["stopNow","returnNow"]),C)return[2,new Promise(function(){})];if(this.setState(w({loading:!0,params:f},A)),$)return[2,Promise.resolve(A.data)];(r=(n=this.options).onBefore)===null||r===void 0||r.call(n,f),T.label=1;case 1:return T.trys.push([1,3,,4]),O=this.runPluginHandler("onRequest",this.serviceRef.current,f).servicePromise,O||(O=(P=this.serviceRef).current.apply(P,b([],y(f),!1))),[4,O];case 2:return R=T.sent(),l!==this.count?[2,new Promise(function(){})]:(this.setState({data:R,error:void 0,loading:!1}),(i=(t=this.options).onSuccess)===null||i===void 0||i.call(t,R,f),this.runPluginHandler("onSuccess",R,f),(a=(o=this.options).onFinally)===null||a===void 0||a.call(o,f,R,void 0),l===this.count&&this.runPluginHandler("onFinally",f,R,void 0),[2,R]);case 3:if(g=T.sent(),l!==this.count)return[2,new Promise(function(){})];throw this.setState({error:g,loading:!1}),(c=(s=this.options).onError)===null||c===void 0||c.call(s,g,f),this.runPluginHandler("onError",g,f),(v=(u=this.options).onFinally)===null||v===void 0||v.call(u,f,void 0,g),l===this.count&&this.runPluginHandler("onFinally",f,void 0,g),g;case 4:return[2]}})})},e.prototype.run=function(){for(var n=this,r=[],t=0;t<arguments.length;t++)r[t]=arguments[t];this.runAsync.apply(this,b([],y(r),!1)).catch(function(i){n.options.onError||console.error(i)})},e.prototype.cancel=function(){this.count+=1,this.setState({loading:!1}),this.runPluginHandler("onCancel")},e.prototype.refresh=function(){this.run.apply(this,b([],y(this.state.params||[]),!1))},e.prototype.refreshAsync=function(){return this.runAsync.apply(this,b([],y(this.state.params||[]),!1))},e.prototype.mutate=function(n){var r=ue(n)?n(this.state.data):n;this.runPluginHandler("onMutate",r),this.setState({data:r})},e}();const pn=hn;function bn(e,n,r){n===void 0&&(n={}),r===void 0&&(r=[]);var t=n.manual,i=t===void 0?!1:t,o=K(n,["manual"]),a=w({manual:i},o),s=Q(e),c=gn(),u=q(function(){var v=r.map(function(f){var h;return(h=f==null?void 0:f.onInit)===null||h===void 0?void 0:h.call(f,a)}).filter(Boolean);return new pn(s,a,c,Object.assign.apply(Object,b([{}],y(v),!1)))},[]);return u.options=a,u.pluginImpls=r.map(function(v){return v(u,a)}),mn(function(){if(!i){var v=u.state.params||n.defaultParams||[];u.run.apply(u,b([],y(v),!1))}}),H(function(){u.cancel()}),{loading:u.state.loading,data:u.state.data,error:u.state.error,params:u.state.params||[],cancel:x(u.cancel.bind(u)),refresh:x(u.refresh.bind(u)),refreshAsync:x(u.refreshAsync.bind(u)),run:x(u.run.bind(u)),runAsync:x(u.runAsync.bind(u)),mutate:x(u.mutate.bind(u))}}function Pn(e,n,r){return bn(e,n,b(b([],y(r||[]),!1),[Xe,Je,Qe,rn,vn,ae,me,un],!1))}export{Q as a,ue as b,H as c,oe as d,L as i,Pn as u};
