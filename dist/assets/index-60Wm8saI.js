import{r as N,j as e,S as A,u as D,a as P,b as z,i as R}from"./index-D48r8r3j.js";import{u as T}from"./useRequest-2FXbrLHu.js";import{u as q,P as F,A as k,a as I,b as M,c as L}from"./index-Ki45TJWi.js";import{h as p,e as H}from"./moment-DewIO7dE.js";import{I as O}from"./InputFiled-a1RovQQJ.js";import{a as B,C as E}from"./index.esm-T7r_Jc6u.js";import{u as S}from"./useMemoryClick-04DI5YfE.js";import{C as U}from"./Create-0NOjqEgW.js";import{a as Q}from"./index-R7o8NJjg.js";import{u as V}from"./useIgnore-a7KGXVgX.js";import"./isObjectLike-dOELDCJ_.js";import"./index-6bBF3xpd.js";import"./intex-LLOGpv4h.js";const $=({sorting:n,column:a,sortTable:s})=>{const t=n.column===a&&n.order==="desc";return e.jsx("td",{className:"font-[500] min-w-[95px]",onClick:()=>{s(t?{column:a,order:"asc"}:{column:a,order:"desc"})},children:e.jsx("div",{className:" ",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{children:[" ",a]}),e.jsxs("div",{className:"w-full text-right opacity-0 hover:opacity-100 transition-all duration-300 ease-in-out",children:[e.jsx("span",{className:"inline-block ",children:e.jsx(k,{})}),e.jsx("span",{className:`mr-2 inline-block transition-all ease-in-out duration-300 ${t?"rotate-[180deg] opacity-100":"opacity-0"}`,children:e.jsx(k,{})})]})]})})},a)},G=({columns:n,sorting:a,sortTable:s})=>e.jsx("thead",{className:"capitalize",children:e.jsx("tr",{className:"  border-b text-left whitespace-nowrap  h-[50px] text-[14px] font-[700]",children:n.map(t=>e.jsx($,{sorting:a,sortTable:s,column:t},t))})}),J=({entries:n})=>e.jsx("tbody",{className:"text-[13px]",children:n==null?void 0:n.map((a,s)=>e.jsxs("tr",{className:"border-b h-[70px] capitalize text-left",children:[e.jsx("td",{children:a.no}),e.jsx("td",{className:"min-w-[160px]",children:p(a.transactionDate).format("lll")}),e.jsx("td",{className:"min-w-[160px]",children:a.transactionId}),e.jsx("td",{className:"min-w-[150px]",children:a.fullname||"Delete user account"}),e.jsx("td",{className:"min-w-[180px]",children:a.merchantName}),e.jsx("td",{className:"min-w-[130px]",children:a.packageName}),e.jsx("td",{children:a.amount}),e.jsx("td",{children:a.actualAmount}),e.jsx("td",{children:a.transactionFees}),e.jsx("td",{children:a.actualAmount}),e.jsx("td",{children:a.paymentChannelName}),e.jsx("td",{children:a.transaction_status})]},s))}),K=({data:n,loading:a})=>{const s=["no","Date","Transaction Id","name","Connected Merchants","Package","Amount","Actual Amount","Transaction Fee","Total","Payment Method","Payment Status"],[t,o]=S({column:"no",order:"asc"}),{data:h}={...n},{data:i}={...h},{result:x=[],total:d=0}={...i},c=N.useRef(null),m=Q(c),{recordPerPage:b,getPaginatedData:w,goToNextPage:f,changePage:j,paginationRange:y,pageNumbersCount:v,currentPage:l,goToPreviousPage:u,setRecordPerPage:g}=q(d),C=x.map((r,_)=>({no:_+1,transactionId:r.transaction_id,fullname:r.fullname,merchantName:r.merchant_name,packageName:r.package_name,merchantUserId:r.merchant_user_id,paymentChannelName:r.payment_channel_name,amount:r.amount,transactionFees:r.transaction_fees,transactionPercentage:r.transaction_percentage,actualAmount:r.actual_amount,transaction_status:r.transaction_status,transactionDate:r.transaction_date})),Y=N.useMemo(()=>{if(t.order==="desc")return C.reverse();if(t.order=="asc")return C},[t.order,j]);return e.jsxs("div",{ref:c,className:"w-full bg-white px-5 pt-5 pb-10 relative min-h-[300px]  rounded-md shadow-sm  cursor-pointer",children:[e.jsxs("div",{className:"w-full overflow-x-scroll min-h-[300px] ",children:[a&&e.jsxs("div",{style:m,className:"absolute bg-[#ffffff50]  top-0 left-0 w-full h-full z-[60] flex justify-center items-center",children:[e.jsx(A,{width:24,height:24}),e.jsx("div",{className:"absolute top-0 left-0 w-full bg-[#ffffff50] z-50  blur-[20px] h-full  flex justify-center items-center"})]}),Y.length==0&&!a&&e.jsx("div",{style:m,className:"absolute top-0 left-0 w-full  h-full  flex justify-center items-center",children:e.jsx("p",{children:"No Data"})}),e.jsxs("table",{className:"w-full",children:[e.jsx(G,{columns:s,sorting:t,sortTable:o}),Y.length!==0&&e.jsx(J,{entries:Y})]})]}),e.jsx("div",{className:"absolute w-full bottom-0 left-0 px-4 ",children:e.jsx(F,{recordPerPage:b,currentPage:l,getPaginatedData:w,goToNextPage:f,goToPreviousPage:u,changePage:j,paginationRange:y,pageNumbersCount:v,setRecordPerPage:g})})]})},W=({data:n,loading:a})=>{const[s,t]=N.useState(new Date),{handleMass:o}=V(l=>l),h=I(),i=h.get("limit"),x=h.get("date"),d=D(),{control:c,handleSubmit:m,reset:b}=B({mode:"all",defaultValues:{user:"",year:""}}),[w,f]=S(!1),j=N.useCallback(()=>{f(l=>!l)},[]),y=()=>{f(!1)},v=l=>{const u=p(l.year).format("YYYY"),g=i||"5";x===p(s).format("YYYY")?d(location.pathname+"?date="+x+"&q="+l.user+"&page=1&limit="+g):d(location.pathname+"?date="+u+"&q="+l.user+"&page=1&limit="+g)};return e.jsxs("div",{children:[e.jsx(U,{handleOpen:j,handleClose:y,open:w}),e.jsx("div",{className:"flex justify-between items-center mb-3",children:e.jsxs("form",{onSubmit:m(v),className:" flex items-center  gap-3",children:[e.jsx(O,{placeholder:"User or Merchant",className:"max-w-[250px] ",label:"Search",name:"user",control:c}),e.jsxs("div",{children:[e.jsx("p",{className:" text-sm mb-1",children:"Yearly"}),e.jsx(E,{name:"year",control:c,render:({field:{onChange:l}})=>e.jsx(H,{selected:s,onChange:u=>{o(u),t(u),l(u)},startDate:s,dateFormat:"yyyy",showYearPicker:!0,className:"rounded-md  bg-[#efefef] px-3 py-2 "})})]}),e.jsx(P.Button,{type:"submit",placeholder:"search",className:"capitalize mt-6 shadow-none rounded-md",color:"blue",children:"Search"}),e.jsx(P.Button,{onClick:()=>{b();const l=i||"5";setTimeout(()=>{d(location.pathname+"?date="+p(new Date).format("YYYY")+"&page=1&limit="+l)},100),t(new Date)},placeholder:"Reset",className:"capitalize mt-6 shadow-none rounded-md",color:"black",children:"Reset"})]})}),e.jsx(K,{data:n,loading:a})]})},X=()=>{const n=I(),a=n.get("page"),s=n.get("limit"),t=n.get("q"),o=n.get("date"),h=D(),i=z(),{loading:x,data:d,runAsync:c}=T(R,{manual:!0});return M(()=>{const m=p(new Date).format("YYYY");h(i.pathname+"?date="+m),c({year:m,limit:s||"5"})}),L(()=>{t?c({q:t,limit:s||"5",page:a,year:o}):s&&a&&o&&!t?c({limit:s,page:a,year:o}):s&&a&&o&&t?c({limit:s,page:a,year:o,q:t}):o&&t?c({year:o,q:t}):t&&c({q:t})},[a,s,t,o]),e.jsx("div",{className:"px-6 pt-6",children:e.jsx(W,{data:d,loading:x})})},Z=()=>e.jsx("div",{children:e.jsx(X,{})}),he=()=>e.jsx(Z,{});export{he as default};
